{
    "comment": "Expression Parser",

    "lex": {
        "rules": [
            ["\\s+", "/* skip whitespace */"],
            ["in", "return 'in'"],
            ["true", "return 'TRUE'"],
            ["false", "return 'FALSE'"],
            ["(['\"])[\\w-\\s]*\\1", "return 'STRING'"],
            ["(?!['\"\\d])[\\w\\$'\"][\\w\\.\\[\\]\\$'\"]*", "return 'KEY'"],
            ["\\[.*\\]", "return 'ARRAY'"],
            ["[0-9]+", "return 'NUMBER'"],
            ["===", "return '==='"],
            ["!==", "return '!=='"],
            ["\\(", "return 'LEFT'"],
            ["\\)", "return 'RIGHT'"],
            ["\\.", "return 'DOT'"],
            ["\\+|\\-|\\*|\/|==|>=|<=|>|<|!=|&&|\\|\\|", "return yytext"],
            ["!", "return 'NOT'"],
            ["$", "return 'EOF'"]
        ]
    },

    "operators": [
        ["left", "!"],
        ["left", "||", "&&"],
        ["left", ">", "<", ">=", "==", "<=", "!=", "===", "!==", "in"],
        ["left", "+", "-"],
        ["left", "*", "/"]
    ],

    "bnf": {
        "expressions": [
            ["program EOF", "return $1;"]
        ],

        "program": [
            ["NOT e", "$$ = !$2;"],
            ["e", "$$ = $1;"]
        ],

        "e": [
            ["e + e", "$$ = $1+$3; "],
            ["e - e", "$$ = $1-$3; "],
            ["e * e", "$$ = $1*$3; "],
            ["e / e", "$$ = $1/$3; "],
            ["e > e", "$$ = $1>$3; "],
            ["e < e", "$$ = $1<$3; "],
            ["e == e", "$$ = $1==$3; "],
            ["e >= e", "$$ = $1>=$3; "],
            ["e <= e", "$$ = $1<=$3; "],
            ["e != e", "$$ = $1!=$3; "],
            ["e !== e", "$$ = $1!==$3; "],
            ["e === e", "$$ = $1===$3; "],
            ["e || e", "$$ = $1||$3; "],
            ["e && e", "$$ = $1&&$3; "],
            ["e in e", "$$ = $3.indexOf($1) > -1; "],
            ["LEFT e RIGHT", "$$ = $2;"],
            ["KEY", "$$ = parseGet(yy.parser.__currentObject, yytext);"],
            ["KEY LEFT RIGHT", "$$ = parseGet(yy.parser.__currentObject, $1); if(typeof $$ =='function'){$$ = $$();}"],
            ["KEY LEFT RIGHT DOT KEY", "$$ = parseGet(yy.parser.__currentObject, $1); if(typeof $$ =='function'){$$ = $$();}; $$= parseGet($$, $5);"],
            ["TRUE", "$$ = true"],
            ["FALSE", "$$ = false"],
            ["NUMBER", "$$ = Number(yytext)"],
            ["ARRAY", "$$ = yytext"],
            ["STRING", "$$ = yytext.replace(/(['\"])([\\w-\\s]*)\\1/,function(all,quote,str){return str;}); "]
        ]
    }
}
